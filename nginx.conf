# Nginx configuration for SPA routing
# Добавьте это в блок server {} вашего nginx конфига

server {
    listen 80;
    server_name your-domain.com;
    root /path/to/your/dist;
    index index.html;

    # Основные настройки
    location / {
        try_files $uri $uri/ =404;
    }

    # Правило для динамических роутов товаров: /catalog/product/{slug}
    location ~ ^/catalog/product/[^/]+/?$ {
        try_files $uri /catalog/product/index.html;
    }

    # Правило для динамических роутов категорий: /catalog/{category-slug}
    location ~ ^/catalog/[^/]+/?$ {
        try_files $uri /catalog/index.html;
    }

    # Правило для динамических роутов постов: /blog/post/{slug}
    location ~ ^/blog/post/[^/]+/?$ {
        try_files $uri /blog/post/index.html;
    }

    # Кеширование статических файлов
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|webp|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Отключаем кеширование для HTML
    location ~* \.html$ {
        add_header Cache-Control "no-cache, no-store, must-revalidate";
    }
}
